<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><link rel="canonical" href="https://nosejs.github.io/ngx-restangular/configuring/"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>配置 - Ngx-restangular Docs</title><link rel="stylesheet" href="../assets/stylesheets/application.4031d38b.css"><script src="../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../assets/fonts/material-icons.css"></head><body dir="ltr"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#configuring-restangular" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="https://nosejs.github.io/ngx-restangular/" title="Ngx-restangular Docs" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">Ngx-restangular Docs</span><span class="md-header-nav__topic">配置</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/nosejs/ngx-restangular/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div></div></div></nav></header><div class="md-container"><nav class="md-tabs" data-md-component="tabs"><div class="md-tabs__inner md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href=".." title="主页" class="md-tabs__link md-tabs__link--active">主页</a></li></ul></div></nav><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="https://nosejs.github.io/ngx-restangular/" title="Ngx-restangular Docs" class="md-nav__button md-logo"><i class="md-icon"></i></a>Ngx-restangular Docs</label><div class="md-nav__source"><a href="https://github.com/nosejs/ngx-restangular/" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">GitHub</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." title="主页" class="md-nav__link">主页</a></li><li class="md-nav__item"><a href="../starter-guide/" title="入门" class="md-nav__link">入门</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">配置</label><a href="./" title="配置" class="md-nav__link md-nav__link--active">配置</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#configuring-restangular" title="Configuring Restangular" class="md-nav__link">Configuring Restangular</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#properties" title="Properties" class="md-nav__link">Properties</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#withconfig" title="withConfig" class="md-nav__link">withConfig</a></li><li class="md-nav__item"><a href="#setbaseurl" title="setBaseUrl" class="md-nav__link">setBaseUrl</a></li><li class="md-nav__item"><a href="#setextrafields" title="setExtraFields" class="md-nav__link">setExtraFields</a></li><li class="md-nav__item"><a href="#setparentless" title="setParentless" class="md-nav__link">setParentless</a></li><li class="md-nav__item"><a href="#addelementtransformer" title="addElementTransformer" class="md-nav__link">addElementTransformer</a></li><li class="md-nav__item"><a href="#settransformonlyserverelements" title="setTransformOnlyServerElements" class="md-nav__link">setTransformOnlyServerElements</a></li><li class="md-nav__item"><a href="#setonelemrestangularized" title="setOnElemRestangularized" class="md-nav__link">setOnElemRestangularized</a></li><li class="md-nav__item"><a href="#addresponseinterceptor" title="addResponseInterceptor" class="md-nav__link">addResponseInterceptor</a></li><li class="md-nav__item"><a href="#addfullrequestinterceptor" title="addFullRequestInterceptor" class="md-nav__link">addFullRequestInterceptor</a></li><li class="md-nav__item"><a href="#adderrorinterceptor" title="addErrorInterceptor" class="md-nav__link">addErrorInterceptor</a></li><li class="md-nav__item"><a href="#setrestangularfields" title="setRestangularFields" class="md-nav__link">setRestangularFields</a></li><li class="md-nav__item"><a href="#setmethodoverriders" title="setMethodOverriders" class="md-nav__link">setMethodOverriders</a></li><li class="md-nav__item"><a href="#setdefaultrequestparams" title="setDefaultRequestParams" class="md-nav__link">setDefaultRequestParams</a></li><li class="md-nav__item"><a href="#setfullresponse" title="setFullResponse" class="md-nav__link">setFullResponse</a></li><li class="md-nav__item"><a href="#setdefaultheaders" title="setDefaultHeaders" class="md-nav__link">setDefaultHeaders</a></li><li class="md-nav__item"><a href="#setrequestsuffix" title="setRequestSuffix" class="md-nav__link">setRequestSuffix</a></li><li class="md-nav__item"><a href="#setusecannonicalid" title="setUseCannonicalId" class="md-nav__link">setUseCannonicalId</a></li><li class="md-nav__item"><a href="#setplainbydefault" title="setPlainByDefault" class="md-nav__link">setPlainByDefault</a></li><li class="md-nav__item"><a href="#setencodeids" title="setEncodeIds" class="md-nav__link">setEncodeIds</a></li></ul></nav></li><li class="md-nav__item"><a href="#accessing-configuration" title="Accessing configuration" class="md-nav__link">Accessing configuration</a></li><li class="md-nav__item"><a href="#how-to-configure-them-globally" title="How to configure them globally" class="md-nav__link">How to configure them globally</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#configuring-in-the-appmodule" title="Configuring in the AppModule" class="md-nav__link">Configuring in the AppModule</a></li><li class="md-nav__item"><a href="#configuring-in-the-appmodule-with-dependency-injection-applied" title="Configuring in the AppModule with Dependency Injection applied" class="md-nav__link">Configuring in the AppModule with Dependency Injection applied</a></li></ul></nav></li><li class="md-nav__item"><a href="#how-to-create-a-restangular-service-with-a-different-configuration-from-the-global-one" title="How to create a Restangular service with a different configuration from the global one" class="md-nav__link">How to create a Restangular service with a different configuration from the global one</a></li><li class="md-nav__item"><a href="#decoupled-restangular-service" title="Decoupled Restangular Service" class="md-nav__link">Decoupled Restangular Service</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="../methods/" title="方法" class="md-nav__link">方法</a></li><li class="md-nav__item"><a href="../copying-elements/" title="复制元素" class="md-nav__link">复制元素</a></li><li class="md-nav__item"><a href="../observables/" title="Observables" class="md-nav__link">Observables</a></li><li class="md-nav__item"><a href="../url-building/" title="链接构建" class="md-nav__link">链接构建</a></li><li class="md-nav__item"><a href="../creating-new-methods/" title="创建新方法" class="md-nav__link">创建新方法</a></li><li class="md-nav__item"><a href="../custom/" title="自定义" class="md-nav__link">自定义</a></li><li class="md-nav__item"><a href="../faq/" title="FAQ" class="md-nav__link">FAQ</a></li><li class="md-nav__item"><a href="../server-frameworks/" title="服务框架" class="md-nav__link">服务框架</a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#configuring-restangular" title="Configuring Restangular" class="md-nav__link">Configuring Restangular</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#properties" title="Properties" class="md-nav__link">Properties</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#withconfig" title="withConfig" class="md-nav__link">withConfig</a></li><li class="md-nav__item"><a href="#setbaseurl" title="setBaseUrl" class="md-nav__link">setBaseUrl</a></li><li class="md-nav__item"><a href="#setextrafields" title="setExtraFields" class="md-nav__link">setExtraFields</a></li><li class="md-nav__item"><a href="#setparentless" title="setParentless" class="md-nav__link">setParentless</a></li><li class="md-nav__item"><a href="#addelementtransformer" title="addElementTransformer" class="md-nav__link">addElementTransformer</a></li><li class="md-nav__item"><a href="#settransformonlyserverelements" title="setTransformOnlyServerElements" class="md-nav__link">setTransformOnlyServerElements</a></li><li class="md-nav__item"><a href="#setonelemrestangularized" title="setOnElemRestangularized" class="md-nav__link">setOnElemRestangularized</a></li><li class="md-nav__item"><a href="#addresponseinterceptor" title="addResponseInterceptor" class="md-nav__link">addResponseInterceptor</a></li><li class="md-nav__item"><a href="#addfullrequestinterceptor" title="addFullRequestInterceptor" class="md-nav__link">addFullRequestInterceptor</a></li><li class="md-nav__item"><a href="#adderrorinterceptor" title="addErrorInterceptor" class="md-nav__link">addErrorInterceptor</a></li><li class="md-nav__item"><a href="#setrestangularfields" title="setRestangularFields" class="md-nav__link">setRestangularFields</a></li><li class="md-nav__item"><a href="#setmethodoverriders" title="setMethodOverriders" class="md-nav__link">setMethodOverriders</a></li><li class="md-nav__item"><a href="#setdefaultrequestparams" title="setDefaultRequestParams" class="md-nav__link">setDefaultRequestParams</a></li><li class="md-nav__item"><a href="#setfullresponse" title="setFullResponse" class="md-nav__link">setFullResponse</a></li><li class="md-nav__item"><a href="#setdefaultheaders" title="setDefaultHeaders" class="md-nav__link">setDefaultHeaders</a></li><li class="md-nav__item"><a href="#setrequestsuffix" title="setRequestSuffix" class="md-nav__link">setRequestSuffix</a></li><li class="md-nav__item"><a href="#setusecannonicalid" title="setUseCannonicalId" class="md-nav__link">setUseCannonicalId</a></li><li class="md-nav__item"><a href="#setplainbydefault" title="setPlainByDefault" class="md-nav__link">setPlainByDefault</a></li><li class="md-nav__item"><a href="#setencodeids" title="setEncodeIds" class="md-nav__link">setEncodeIds</a></li></ul></nav></li><li class="md-nav__item"><a href="#accessing-configuration" title="Accessing configuration" class="md-nav__link">Accessing configuration</a></li><li class="md-nav__item"><a href="#how-to-configure-them-globally" title="How to configure them globally" class="md-nav__link">How to configure them globally</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#configuring-in-the-appmodule" title="Configuring in the AppModule" class="md-nav__link">Configuring in the AppModule</a></li><li class="md-nav__item"><a href="#configuring-in-the-appmodule-with-dependency-injection-applied" title="Configuring in the AppModule with Dependency Injection applied" class="md-nav__link">Configuring in the AppModule with Dependency Injection applied</a></li></ul></nav></li><li class="md-nav__item"><a href="#how-to-create-a-restangular-service-with-a-different-configuration-from-the-global-one" title="How to create a Restangular service with a different configuration from the global one" class="md-nav__link">How to create a Restangular service with a different configuration from the global one</a></li><li class="md-nav__item"><a href="#decoupled-restangular-service" title="Decoupled Restangular Service" class="md-nav__link">Decoupled Restangular Service</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/nosejs/ngx-restangular.git/configuring.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a><h1>配置</h1><h2 id="configuring-restangular">Configuring Restangular</h2>
<h3 id="properties">Properties</h3>
<p>Restangular comes with defaults for all of its properties but you can configure them. <strong>So, if you don't need to configure something, there's no need to add the configuration.</strong>
You can set all these configurations in <strong><a href="#how-to-configure-them-globally">RestangularModule</a> to change the global configuration</strong>, you can also <strong>use the <a href="#how-to-create-a-restangular-service-with-a-different-configuration-from-the-global-one">withConfig</a> method in Restangular service to create a new Restangular service with some scoped configuration</strong> or <strong>use <a href="#withconfig">withConfig</a> in component to make specified Restangular</strong></p>
<h4 id="withconfig">withConfig</h4>
<p>You can configure Restangular "withConfig" like in example below, you can also configure them globally <a href="#how-to-configure-them-globally">RestangularModule</a> or in service with <a href="#how-to-create-a-restangular-service-with-a-different-configuration-from-the-global-one">withConfig</a></p>
<pre><code class="javascript">// Function for settting the default restangular configuration
export function RestangularConfigFactory (RestangularProvider) {
  RestangularProvider.setBaseUrl('http://www.google.com');
}

@NgModule({
  bootstrap: [ AppComponent ],
  declarations: [
    AppComponent,
  ],
  imports: [
    // Global configuration
    RestangularModule.forRoot(RestangularConfigFactory),
  ]
})
export class AppModule {}
// Let's use it in the component
@Component({
  ...
})
export class OtherComponent {
  constructor(private restangular: Restangular) {}

  ngOnInit() {
    restangular.withConfig((RestangularConfigurer) =&gt; {
      RestangularConfigurer.setBaseUrl('http://www.bing.com');
    }).all('users').getList()
  }
};
</code></pre>

<h4 id="setbaseurl">setBaseUrl</h4>
<p>The base URL for all calls to your API. For example if your URL for fetching accounts is http://example.com/api/v1/accounts, then your baseUrl is <code>/api/v1</code>. The default baseUrl is an empty string which resolves to the same url that Angular2 is running, but you can also set an absolute url like <code>http://api.example.com/api/v1</code> if you need to set another domain.</p>
<h4 id="setextrafields">setExtraFields</h4>
<p>These are the fields that you want to save from your parent resources if you need to display them. By default this is an Empty Array which will suit most cases</p>
<h4 id="setparentless">setParentless</h4>
<p>Use this property to control whether Restangularized elements to have a parent or not. So, for example if you get an account and then get a nested list of buildings, you may want the buildings URL to be simple <code>/buildings/123</code> instead of <code>/accounts/123/buildings/123</code>. This property lets you do that.</p>
<p>This method accepts 1 parameter, it could be:</p>
<ul>
<li>Boolean: Specifies if all elements should be parentless or not</li>
<li>Array: Specifies the routes (types) of all elements that should be parentless. For example <code>['buildings']</code></li>
</ul>
<h4 id="addelementtransformer">addElementTransformer</h4>
<p>This is a hook. After each element has been "restangularized" (Added the new methods from Restangular), the corresponding transformer will be called if it fits.</p>
<p>This should be used to add your own methods / functions to entities of certain types.</p>
<p>You can add as many element transformers as you want. The signature of this method can be one of the following:</p>
<ul>
<li>
<p><strong>addElementTransformer(route, transformer)</strong>: Transformer is called with all elements that have been restangularized, no matter if they're collections or not.</p>
</li>
<li>
<p><strong>addElementTransformer(route, isCollection, transformer)</strong>: Transformer is called with all elements that have been restangularized and match the specification regarding if it's a collection or not (true | false)</p>
</li>
</ul>
<h4 id="settransformonlyserverelements">setTransformOnlyServerElements</h4>
<p>This sets whether transformers will be run for local objects and not by objects returned by the server. This is by default true but can be changed to false if needed (Most people won't need this).</p>
<h4 id="setonelemrestangularized">setOnElemRestangularized</h4>
<p>This is a hook. After each element has been "restangularized" (Added the new methods from Restangular), this will be called. It means that if you receive a list of objects in one call, this method will be called first for the collection and then for each element of the collection.</p>
<p><strong>I favor the usage of <code>addElementTransformer</code> instead of <code>onElemRestangularized</code> whenever possible as the implementation is much cleaner.</strong></p>
<p>This callback is a function that has 4 parameters:</p>
<ul>
<li><strong>elem</strong>: The element that has just been restangularized. Can be a collection or a single element.</li>
<li><strong>isCollection</strong>: Boolean indicating if this is a collection or a single element.</li>
<li><strong>what</strong>: The model that is being modified. This is the "path" of this resource. For example <code>buildings</code></li>
<li><strong>Restangular</strong>: The instanced service to use any of its methods</li>
</ul>
<p>This can be used together with <code>addRestangularMethod</code> (Explained later) to add custom methods to an element</p>
<pre><code class="javascript">service.setOnElemRestangularized((element, isCollection, what, Restangular) =&gt; {
  element.newField = &quot;newField&quot;;
  return element;
});
</code></pre>

<h4 id="addresponseinterceptor">addResponseInterceptor</h4>
<p>The responseInterceptor is called after we get each response from the server. It's a function that receives this arguments:</p>
<ul>
<li><strong>data</strong>: The data received got from the server</li>
<li><strong>operation</strong>: The operation made. It'll be the HTTP method used except for a <code>GET</code> which returns a list of element which will return <code>getList</code> so that you can distinguish them.</li>
<li><strong>what</strong>: The model that's being requested. It can be for example: <code>accounts</code>, <code>buildings</code>, etc.</li>
<li><strong>url</strong>: The relative URL being requested. For example: <code>/api/v1/accounts/123</code></li>
<li><strong>response</strong>: Full server response including headers</li>
</ul>
<p>Some of the use cases of the responseInterceptor are handling wrapped responses and enhancing response elements with more methods among others.</p>
<p>The responseInterceptor must return the restangularized data element.</p>
<pre><code class="javascript"> RestangularProvider.addResponseInterceptor((data, operation, what, url, response)=&gt; {
       return data;
     });
 });
</code></pre>

<h4 id="addfullrequestinterceptor">addFullRequestInterceptor</h4>
<p>This adds a new fullRequestInterceptor. The fullRequestInterceptor is similar to the <code>requestInterceptor</code> but more powerful. It lets you change the element, the request parameters and the headers as well.</p>
<p>It's a function that receives the same as the <code>requestInterceptor</code> plus the headers and the query parameters (in that order).</p>
<p>It can return an object with any (or all) of following properties:
<em> <strong>headers</strong>: The headers to send
</em> <strong>params</strong>: The request parameters to send
* <strong>element</strong>: The element to send</p>
<pre><code class="javascript">RestangularProvider.addFullRequestInterceptor((element, operation, path, url, headers, params)=&gt; {
   return {
     params: Object.assign({}, params, {sort:&quot;name&quot;}),
     headers: headers,
     element: element
   }
 });
</code></pre>

<p>If a property isn't returned, the one sent is used.</p>
<h4 id="adderrorinterceptor">addErrorInterceptor</h4>
<p>The errorInterceptor is called whenever there's an error. It's a function that receives the response, subject and the Restangular-response handler as parameters.</p>
<p>The errorInterceptor function, whenever it returns false, prevents the observable linked to a Restangular request to be executed. All other return values (besides false) are ignored and the observable follows the usual path, eventually reaching the success or error hooks.</p>
<p>The refreshAccesstoken function must return observable. It`s function that will be done before repeating the request, there you can make some actions. In switchMap you might do some transformations to request.</p>
<pre><code class="javascript">// Function for settting the default restangular configuration
export function RestangularConfigFactory (RestangularProvider, authService) {
  RestangularProvider.setBaseUrl('http://api.test.com/v1');

  // This function must return observable
  var refreshAccesstoken = function () {
    // Here you can make action before repeated request
    return authService.functionForTokenUpdate();
  };

  RestangularProvider.addErrorInterceptor((response, subject, responseHandler) =&gt; {
    if (response.status === 403) {

      refreshAccesstoken()
      .switchMap(refreshAccesstokenResponse =&gt; {
        //If you want to change request or make with it some actions and give the request to the repeatRequest func.
        //Or you can live it empty and request will be the same.

        // update Authorization header
        response.request.headers.set('Authorization', 'Bearer ' + refreshAccesstokenResponse)

        return response.repeatRequest(response.request);
      })
      .subscribe(
        res =&gt; responseHandler(res),
        err =&gt; subject.error(err)
      );

      return false; // error handled
    }
    return true; // error not handled
  });
}

// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  bootstrap: [ AppComponent ],
  imports: [
    // Importing RestangularModule and making default configs for restanglar
    RestangularModule.forRoot([authService], RestangularConfigFactory),
  ],
})
</code></pre>

<h4 id="setrestangularfields">setRestangularFields</h4>
<p>Restangular required 3 fields for every "Restangularized" element. These are:</p>
<ul>
<li>id: Id of the element. Default: id</li>
<li>route: Name of the route of this element. Default: route</li>
<li>parentResource: The reference to the parent resource. Default: parentResource</li>
<li>restangularCollection: A boolean indicating if this is a collection or an element. Default: restangularCollection</li>
<li>cannonicalId: If available, the path to the cannonical ID to use. Useful for PK changes</li>
<li>etag: Where to save the ETag received from the server. Defaults to <code>restangularEtag</code></li>
<li>selfLink: The path to the property that has the URL to this item. If your REST API doesn't return a URL to an item, you can just leave it blank. Defaults to <code>href</code></li>
</ul>
<p>Also all of Restangular methods and functions are configurable through restangularFields property.
All of these fields except for <code>id</code> and <code>selfLink</code> are handled by Restangular, so most of the time you won't change them. You can configure the name of the property that will be binded to all of this fields by setting restangularFields property.</p>
<h4 id="setmethodoverriders">setMethodOverriders</h4>
<p>You can now Override HTTP Methods. You can set here the array of methods to override. All those methods will be sent as POST and Restangular will add an X-HTTP-Method-Override header with the real HTTP method we wanted to do.</p>
<pre><code class="javascript">RestangularProvider.setMethodOverriders([&quot;Get&quot;,&quot;Put&quot;]);
</code></pre>

<h4 id="setdefaultrequestparams">setDefaultRequestParams</h4>
<p>You can set default Query parameters to be sent with every request and every method.</p>
<p>Additionally, if you want to configure request params per method, you can use <code>requestParams</code> configuration similar to <code>$http</code>. For example <code>RestangularProvider.requestParams.get = {single: true}</code>.</p>
<p>Supported method to configure are: remove, get, post, put, common (all)</p>
<pre><code class="javascript">// set params for multiple methods at once
RestangularProvider.setDefaultRequestParams(['remove', 'post'], {confirm: true});

// set only for get method
RestangularProvider.setDefaultRequestParams('get', {limit: 10});

// or for all supported request methods
RestangularProvider.setDefaultRequestParams({apikey: &quot;secret key&quot;});
</code></pre>

<h4 id="setfullresponse">setFullResponse</h4>
<p>You can set fullResponse to true to get the whole response every time you do any request. The full response has the restangularized data in the <code>data</code> field, and also has the headers and config sent. By default, it's set to false. Please note that in order for Restangular to access custom HTTP headers, your server must respond having the <code>Access-Control-Expose-Headers:</code> set.</p>
<pre><code class="javascript">// set params for multiple methods at once
RestangularProvider.setFullResponse(true);
</code></pre>

<p>Or set it per service</p>
<pre><code class="javascript">// Restangular factory that uses setFullResponse
export const REST_FUL_RESPONSE = new InjectionToken&lt;any&gt;('RestFulResponse');
export function RestFulResponseFactory(restangular: Restangular) {
  return restangular.withConfig((RestangularConfigurer) =&gt; {
    RestangularConfigurer.setFullResponse(true);
  });
}


// Configure factory in AppModule module
// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  bootstrap: [ AppComponent ],
  declarations: [
    AppComponent,
  ],
  imports: [RestangularModule],
  providers: [
    { provide: REST_FUL_RESPONSE, useFactory:  RestFulResponseFactory, deps: [Restangular] }
  ]
})
export class AppModule {}


// Let's use it in the component
@Component({
  ...
})
export class OtherComponent {
  users;

  constructor(@Inject(REST_FUL_RESPONSE) public restFulResponse) {
  }

  ngOnInit() {
    this.restFulResponse.all('users').getList().subscribe( response =&gt; {
      this.users = response.data;
      console.log(response.headers);
    });
  }
}
</code></pre>

<h4 id="setdefaultheaders">setDefaultHeaders</h4>
<p>You can set default Headers to be sent with every request. Send format: {header_name: header_value}</p>
<pre><code class="javascript">import { NgModule } from '@angular/core';
import { RestangularModule, Restangular } from 'ngx-restangular';

// Function for settting the default restangular configuration
export function RestangularConfigFactory (RestangularProvider) {
  RestangularProvider.setDefaultHeaders({'Authorization': 'Bearer UDXPx-Xko0w4BRKajozCVy20X11MRZs1'});
}

// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  ...
  imports: [
    // Importing RestangularModule and making default configs for restanglar
    RestangularModule.forRoot(RestangularConfigFactory),
  ]
})
export class AppModule {
}
</code></pre>

<h4 id="setrequestsuffix">setRequestSuffix</h4>
<p>If all of your requests require to send some suffix to work, you can set it here. For example, if you need to send the format like <code>/users/123.json</code> you can add that <code>.json</code> to the suffix using the <code>setRequestSuffix</code> method</p>
<h4 id="setusecannonicalid">setUseCannonicalId</h4>
<p>You can set this to either <code>true</code> or <code>false</code>. By default it's false. If set to true, then the cannonical ID from the element will be used for URL creation (in DELETE, PUT, POST, etc.). What this means is that if you change the ID of the element and then you do a put, if you set this to true, it'll use the "old" ID which was received from the server. If set to false, it'll use the new ID assigned to the element.</p>
<h4 id="setplainbydefault">setPlainByDefault</h4>
<p>You can set this to <code>true</code> or <code>false</code>. By default it's false. If set to true, data retrieved will be returned with no embed methods from restangular.</p>
<h4 id="setencodeids">setEncodeIds</h4>
<p>You can set here if you want to URL Encode IDs or not. By default, it's true.</p>
<h3 id="accessing-configuration">Accessing configuration</h3>
<p>You can also access the configuration via <code>RestangularModule</code> and <code>Restangular.provider</code> via the <code>configuration</code> property if you don't want to use the setters. Check it out:</p>
<pre><code class="js">RestangularProvider.configuration.requestSuffix = '/';
</code></pre>

<p><strong><a href="#table-of-contents">Back to top</a></strong></p>
<h3 id="how-to-configure-them-globally">How to configure them globally</h3>
<p>You can configure this in either the <code>AppModule</code>.</p>
<h4 id="configuring-in-the-appmodule">Configuring in the <code>AppModule</code></h4>
<pre><code class="javascript">import { RestangularModule } from 'ngx-restangular';

// Function for settting the default restangular configuration
export function RestangularConfigFactory (RestangularProvider) {
  RestangularProvider.setBaseUrl('http://api.restngx.local/v1');
  RestangularProvider.setDefaultHeaders({'Authorization': 'Bearer UDXPx-Xko0w4BRKajozCVy20X11MRZs1'});
}

// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  bootstrap: [ AppComponent ],
  declarations: [
    AppComponent,
  ],
  imports: [
    RestangularModule.forRoot(RestangularConfigFactory),
  ]
})
export class AppModule {
}
</code></pre>

<p><strong><a href="#table-of-contents">Back to top</a></strong></p>
<h4 id="configuring-in-the-appmodule-with-dependency-injection-applied">Configuring in the <code>AppModule</code> with Dependency Injection applied</h4>
<pre><code class="javascript">import { RestangularModule } from 'ngx-restangular';

// Function for settting the default restangular configuration
export function RestangularConfigFactory (RestangularProvider, http) {
  RestangularProvider.setBaseUrl('http://api.restngx.local/v1');
  RestangularProvider.setDefaultHeaders({'Authorization': 'Bearer UDXPx-Xko0w4BRKajozCVy20X11MRZs1'});

  // Example of using Http service inside global config restangular
  RestangularProvider.addElementTransformer('me', true, ()=&gt;{
    return http.get('http://api.test.com/v1/users/2', {});
  });
}

// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  bootstrap: [ AppComponent ],
  declarations: [
    AppComponent,
  ],
  imports: [
    RestangularModule.forRoot([Http], RestangularConfigFactory),
  ]
})
export class AppModule {
}
</code></pre>

<p><strong><a href="#table-of-contents">Back to top</a></strong></p>
<h3 id="how-to-create-a-restangular-service-with-a-different-configuration-from-the-global-one">How to create a Restangular service with a different configuration from the global one</h3>
<p>Let's assume that for most requests you need some configuration (The global one), and for just a bunch of methods you need another configuration. In that case, you'll need to create another Restangular service with this particular configuration. This scoped configuration will inherit all defaults from the global one. Let's see how.</p>
<pre><code class="javascript">// Function for settting the default restangular configuration
export function RestangularConfigFactory (RestangularProvider) {
  RestangularProvider.setBaseUrl('http://www.google.com');
}

//Restangular service that uses Bing
export const RESTANGULAR_BING = new InjectionToken&lt;any&gt;('RestangularBing');
export function RestangularBingFactory(restangular: Restangular) {
  return restangular.withConfig((RestangularConfigurer) =&gt; {
     RestangularConfigurer.setBaseUrl('http://www.bing.com');
   });
}


// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  bootstrap: [ AppComponent ],
  declarations: [
    AppComponent,
  ],
  imports: [
    // Global configuration
    RestangularModule.forRoot(RestangularConfigFactory),
  ],
  providers: [
    { provide: RESTANGULAR_BING, useFactory:  RestangularBingFactory, deps: [Restangular] }
  ]
})
export class AppModule {}


// Let's use it in the component
@Component({
  ...
})
export class OtherComponent {
  constructor(
    @Inject(Restangular) public Restangular,
    @Inject(RESTANGULAR_BING) public RestangularBing
  ) {}

  ngOnInit() {
    // GET to http://www.google.com/users
    // Uses global configuration
    Restangular.all('users').getList()

    // GET to http://www.bing.com/users
    // Uses Bing configuration which is based on Global one, therefore .json is added.
    RestangularBing.all('users').getList()
  }
};
</code></pre>

<p><strong><a href="#table-of-contents">Back to top</a></strong></p>
<h3 id="decoupled-restangular-service">Decoupled Restangular Service</h3>
<p>There're some times where you want to use Restangular but you don't want to expose Restangular object anywhere. For those cases, you can actually use the <code>service</code> feature of Restangular.</p>
<p>Let's see how it works:</p>
<pre><code class="js">// Restangular factory that uses Users
export const USER_REST = new InjectionToken&lt;any&gt;('UserRest');
export function UserRestFactory(restangular: Restangular) {
  return restangular.service('users');
}


// AppModule is the main entry point into Angular2 bootstraping process
@NgModule({
  bootstrap: [ AppComponent ],
  declarations: [
    AppComponent,
  ],
  imports: [RestangularModule],
  providers: [
    { provide: USER_REST, useFactory:  UserRestFactory, deps: [Restangular] } // Configurating our factory
  ]
})
export class AppModule {
}


// Let's use it in the component
export class OtherComponent {
  constructor(@Inject(USER_REST) public User) {
    Users.one(2).get() // GET to /users/2
    Users.post({data}) // POST to /users

    // GET to /users
    Users.getList().subscribe( users =&gt; {
      var user = users[0]; // user === {id: 1, name: &quot;Tonto&quot;}
      user.name = &quot;Gonto&quot;;
      // PUT to /users/1
      user.put();
    })
  }
}
</code></pre>

<p>We can also use Nested RESTful resources with this:</p>
<pre><code class="js">var Cars = Restangular.service('cars', Restangular.one('users', 1));

Cars.getList() // GET to /users/1/cars
</code></pre>

<p><strong><a href="#table-of-contents">Back to top</a></strong></p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../starter-guide/" title="入门" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>入门</span></div></a><a href="../methods/" title="方法" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>方法</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:".."}})</script></body></html>